= Textconv =

''Table of contents:''

__TOC__

= Presentation =

Git is able to use an external driver which converts the real content of an element into something else, preferably more useful for the user. Thus the git machinery (diff, blame ...) can do its treatment on the converted data. The basic use of this is the manipulation of binary files, with which "git diff" is almost useless.

Textconv support for git-diff is available for Git 1.6.1 or later.

A patches series is currently in progress to add textconv support for git-blame and git-gui blame: <ref>[http://mid.gmane.org/1275921713-3277-1-git-send-email-axel.bonnet@ensimag.imag.fr] Patch for git-blame on the mailing-list</ref><ref>[http://mid.gmane.org/1276102929-31712-1-git-send-email-clement.poulain@ensimag.imag.fr] Patch for git-gui blame on the mailing-list</ref>

= How to use =

== Textconv driver configuration ==

Textconv drivers must be specified for the files you want to convert.

==== .gitconfig ====

~/.gitconfig must indicate the command to execute for the the textconv driver:
<pre><nowiki>
[diff "<driver_name>"]
      textconv=<command>
</nowiki></pre>

Here is an example:

<pre><nowiki>
[diff "odf"]
      textconv=odt2txt
</nowiki></pre>

odt2txt command is specified for the odf driver, it is a simple converter from OpenDocument to plain text.

Please note that, in this case, odt2txt must have been installed.


==== .gitattributes ====

[http://www.kernel.org/pub/software/scm/git/docs/gitattributes.html .gitattributes] must associate files to a driver:
<pre><nowiki>
<file pattern> diff=<driver_name>
</nowiki></pre>

Here the continuation of the previous example:

<pre><nowiki>
*.odf diff=odf
*.odt diff=odf
*.odp diff=odf
</nowiki></pre>

It associates the odf driver for the odf, odt and odp files.

To have more information about how to use git to track OpenDocument (OpenOffice, Koffice) files, please refer to [https://git.wiki.kernel.org/index.php/GitTips#How_to_use_git_to_track_OpenDocument_.28OpenOffice.2C_Koffice.29_files.3F this article].

== Blame and diff ==

Now, git blame, git gui blame and git diff will convert files if they have a textconv driver.
If you want to desactivate the conversion, just use the --no-textconv option.

= Demo =

Let's take an example with the file textconv_demo.odt.

== git blame ==
''(patch in progress)''

The command : git blame textconv_demo.odt gives the following result:

<pre><nowiki>
2fad25a7 (Diane Gasselin    2010-06-09 16:50:57 +0200  1) 
2fad25a7 (Diane Gasselin    2010-06-09 16:50:57 +0200  2)   Here is an example of how textconv works with blame.
2fad25a7 (Diane Gasselin    2010-06-09 16:50:57 +0200  3) 
1b6ec1d5 (Axel Bonnet       2010-06-09 16:55:54 +0200  4)   This file has been modified by several users.
1b6ec1d5 (Axel Bonnet       2010-06-09 16:55:54 +0200  5) 
1b6ec1d5 (Axel Bonnet       2010-06-09 16:55:54 +0200  6)   Instead of having a binary output, it presents a nice and
1b6ec1d5 (Axel Bonnet       2010-06-09 16:55:54 +0200  7)   readable one.
1b6ec1d5 (Axel Bonnet       2010-06-09 16:55:54 +0200  8) 
00000000 (Not Committed Yet 2010-06-09 17:46:18 +0200  9)   You only have to specify a driver in your configuration files.
00000000 (Not Committed Yet 2010-06-09 17:46:18 +0200 10) 
</nowiki></pre>

== git gui blame ==
''(patch in progress)''

The command : git gui blame textconv_demo.odt gives the following result:

[[File:Demo_git_gui_blame.jpg|center]]

== git diff ==
''(Git 1.6.1 or later)''
<pre><nowiki>
diff --git a/textconv_demo.odt b/textconv_demo.odt
index b4e6a6d..c08e32e 100644
--- a/textconv_demo.odt
+++ b/textconv_demo.odt
@@ -6,3 +6,5 @@
   Instead of having a binary output, it presents a nice and
   readable one.
 
+  You only have to specify a driver in your configuration files.
+
</nowiki></pre>

= References =
<references/>